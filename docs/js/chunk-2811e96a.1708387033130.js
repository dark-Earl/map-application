(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2811e96a"],{"1a3f":function(n,o,e){},"242d":function(n,o,e){"use strict";e.r(o);var i=function(){var n=this,o=n._self._c;return o("div",[o("map-annotation-test",{attrs:{visible:n.visible}})],1)},t=[],a=function(){var n=this,o=n._self._c;return o("a-modal",{staticClass:"map-mark-modal",attrs:{title:"地图标记","on-ok":"handleOk",width:"600px",height:"750px"},on:{cancel:n.handleCancel},model:{value:n.visible,callback:function(o){n.visible=o},expression:"visible"}},[o("template",{slot:"footer"},[o("a-button",{on:{click:n.cancelMarks}},[n._v(" 取消标记 ")]),o("a-button",{attrs:{type:"primary"},on:{click:n.markOk}},[n._v(" 标记完成 ")])],1),o("div",{attrs:{id:"container"}}),o("div",{staticClass:"locationCity"},[o("a-select",{staticStyle:{width:"85px"},on:{change:n.changeCity},model:{value:n.initCityInfo,callback:function(o){n.initCityInfo=o},expression:"initCityInfo"}},[n._l(n.cityOptions,(function(e){return[o("a-select-option",{key:e.NAME,attrs:{value:"".concat(e.NAME,"_").concat(e.VALUE,"_").concat(e.CENTERPOINT)}},[n._v("\n          "+n._s(e.NAME)+"\n        ")])]}))],2)],1),o("div",{staticClass:"map-mark"},[o("div",{staticClass:"search"},[o("a-input-search",{attrs:{placeholder:"请输入关键字查找","enter-button":"",id:"tipinput"}})],1),o("div",{staticClass:"tol"},[o("ul",[o("li",{staticClass:"mb0"},[o("a",{staticClass:"btn-dd",on:{click:function(o){return n.drawModel("point")}}},[o("i",{staticClass:"icon-dd2"}),o("p",[n._v("打点")])])])])])])],2)},s=[],c=(e("28a5"),e("7f7f"),e("386d"),e("862d")),l=e.n(c),r=e("b047"),p=e.n(r);window._AMapSecurityConfig={securityJsCode:"8d77fab839badf82a6182859ba6722aa"};var u={name:"mapAnnotationTest",props:["visible"],data:function(){var n=p()(this.setLocationInfo,200);return{state:[],markers:[],polylines:[],newMap:null,geocoder:null,curInfo:{level:"county",adcode:""},initLoad:!0,drawWay:"point",mouseTool:null,annotationForm:{SSSF:"500000",SSCS:"500100",SSQX:"",SSXZ:"",SSQY:"",XXDZ:"",TDMJ:"0",TDZC:"0",mapType:"2",fmapPoint:""},initCity:"0591",initCityName:"福州市",initCityInfo:"福州市_0591_[119.238719,26.090374]",CENTERPOINT:[119.238719,26.090374],cityOptions:[{NAME:"福州市",VALUE:"0591",CENTERPOINT:"[119.238719,26.090374]"},{NAME:"广东市",VALUE:"020",CENTERPOINT:"[113.33841,23.142558]"},{NAME:"西安市",VALUE:"029",CENTERPOINT:"[108.945068,34.213686]"},{NAME:"长乐市",VALUE:"0591",CENTERPOINT:"[119.514672,25.959847]"}],resultPoint:null,lln:null,bbb:n}},mounted:function(){this.initAMap(),this.$nextTick((function(){setTimeout((function(){document.getElementsByClassName("amap-toolbar")[0]||location.reload()}),3300)}))},methods:{initAMap:function(){var n=this,o=this;l.a.load({key:"248d1da7430b9cf21c1872f48c771ac6",version:"2.0",plugins:["AMap.ToolBar","AMap.Driving"],AMapUI:{version:"1.1",plugins:[]},Loca:{version:"2.0"}}).then((function(e){n.newMap=new e.Map("container",{resizeEnable:!0,zoom:11,showIndoorMap:!1,zooms:[8,17],center:n.CENTERPOINT});var i=n.newMap,t=null,a={input:"tipinput"};e.plugin(["AMap.ToolBar","AMap.Scale","AMap.ControlBar","AMap.Geocoder","AMap.PlaceSearch","AMap.AutoComplete","AMap.MouseTool"],(function(){i.addControl(new e.ToolBar({position:{left:"50px",top:"120px"}})),i.addControl(new e.Scale),t=new e.Geocoder({radius:1e3,extensions:"all",city:o.initCityName});var n=new e.AutoComplete(a),s=new e.PlaceSearch({map:i,city:o.initCity,citylimit:!0});function c(n){s.setCity(n.poi.adcode),s.search(n.poi.name)}n.on("select",c)})),n.geocoder=t})).catch((function(n){console.log(n)}))},changeCity:function(n){var o=this,e=n.split("_");this.initCity=e[1],this.initCityName=e[0];JSON.parse(e[2]);this.CENTERPOINT=JSON.parse(e[2]),setTimeout((function(){o.initAMap()}),300)},test:function(n){console.log(n)},changeMap:function(n){var o=this.newMap.getZoom(),e=this.newMap.getCenter();this.newMap="3D"===n?new AMap.Map("container",{resizeEnable:!0,zoom:o,showIndoorMap:!1,zooms:[8,17],pitch:50,viewMode:n,center:e,layers:[new AMap.TileLayer.RoadNet({}),new AMap.TileLayer.Satellite]}):new AMap.Map("container",{resizeEnable:!0,zoom:o,showIndoorMap:!1,zooms:[8,17],viewMode:n,center:e})},drawModel:function(n){var o=this,e=this;this.drawWay=n,"point"===n&&(this.annotationForm.mapType="2",this.newMap.on("click",(function(i){if("point"===n){e.removeMarker(),e.mouseTool&&e.mouseTool.close();var t=[i.lnglat.lng,i.lnglat.lat];o.resultPoint=JSON.stringify(t),o.setMarker(t);t.join(",");e.annotationForm.fmapPoint=t.join(","),e.lln=t,e.bbb()}})),e.$message.success("进入标记模式"))},removeMarker:function(){this.markers&&this.newMap.remove(this.markers)},setMarker:function(n){var o=new AMap.Marker({position:n,content:'<i class="icon-loc01"></i>'});o.setMap(this.newMap),this.markers.push(o)},setLocationInfo:function(){var n=this.lln,o=this,e=new AMap.Geocoder({city:o.initCity});e.getAddress(n,(function(n,e){if("complete"===n&&"OK"===e.info){var i=e.regeocode.addressComponent;o.openNotificationWithIcon("success","标记所在位置","".concat(i.province).concat(i.city).concat(i.district).concat(i.township).concat(i.street).concat(i.streetNumber))}}))},handleCancel:function(){this.$emit("closeMap",!0)},locatePoint:function(){var n=this,o=new AMap.Geolocation({enableHighAccuracy:!0,timeout:1e4,maximumAge:0,convert:!0,showButton:!0,buttonPosition:"LB",buttonOffset:new AMap.Pixel(10,20),showMarker:!0,showCircle:!0,panToLocation:!0,zoomToAccuracy:!0});o.getCurrentPosition((function(o,e){"complete"==o?n.$message.success(e.message):n.$message.error(e.message)}))},openNotificationWithIcon:function(n,o,e){this.$notification[n]({message:o,description:e,duration:2.5})},markOk:function(){this.resultPoint?this.$router.push({name:"mapPlaces",params:{resultPoint:this.resultPoint,initCity:this.initCity},query:{resultPoint:this.resultPoint,initCity:this.initCity}}):this.$message.error("请先标记地点!")},cancelMarks:function(){this.resultPoint?this.newMap.clearMap():this.$message.error("请先标记地点!")}}},d=u,f=(e("aee5"),e("2877")),M=Object(f["a"])(d,a,s,!1,null,null,null),A=M.exports,h={name:"mapAnno",components:{mapAnnotationTest:A},data:function(){return{visible:!0}},methods:{boot:function(){this.visible=!this.visible}}},m=h,v=Object(f["a"])(m,i,t,!1,null,"44ae03db",null);o["default"]=v.exports},"862d":function(n,o,e){"use strict";(function(o,e){n.exports=e()})(0,(function(){function n(n){var i=[];return n.AMapUI&&i.push(o(n.AMapUI)),n.Loca&&i.push(e(n.Loca)),Promise.all(i)}function o(n){return new Promise((function(o,e){var c=[];if(n.plugins)for(var l=0;l<n.plugins.length;l+=1)-1==t.AMapUI.plugins.indexOf(n.plugins[l])&&c.push(n.plugins[l]);if(a.AMapUI===i.failed)e("前次请求 AMapUI 失败");else if(a.AMapUI===i.notload){a.AMapUI=i.loading,t.AMapUI.version=n.version||t.AMapUI.version,l=t.AMapUI.version;var r=document.body||document.head,p=document.createElement("script");p.type="text/javascript",p.src="https://webapi.amap.com/ui/"+l+"/main.js",p.onerror=function(n){a.AMapUI=i.failed,e("请求 AMapUI 失败")},p.onload=function(){if(a.AMapUI=i.loaded,c.length)window.AMapUI.loadUI(c,(function(){for(var n=0,e=c.length;n<e;n++){var i=c[n].split("/").slice(-1)[0];window.AMapUI[i]=arguments[n]}for(o();s.AMapUI.length;)s.AMapUI.splice(0,1)[0]()}));else for(o();s.AMapUI.length;)s.AMapUI.splice(0,1)[0]()},r.appendChild(p)}else a.AMapUI===i.loaded?n.version&&n.version!==t.AMapUI.version?e("不允许多个版本 AMapUI 混用"):c.length?window.AMapUI.loadUI(c,(function(){for(var n=0,e=c.length;n<e;n++){var i=c[n].split("/").slice(-1)[0];window.AMapUI[i]=arguments[n]}o()})):o():n.version&&n.version!==t.AMapUI.version?e("不允许多个版本 AMapUI 混用"):s.AMapUI.push((function(n){n?e(n):c.length?window.AMapUI.loadUI(c,(function(){for(var n=0,e=c.length;n<e;n++){var i=c[n].split("/").slice(-1)[0];window.AMapUI[i]=arguments[n]}o()})):o()}))}))}function e(n){return new Promise((function(o,e){if(a.Loca===i.failed)e("前次请求 Loca 失败");else if(a.Loca===i.notload){a.Loca=i.loading,t.Loca.version=n.version||t.Loca.version;var c=t.Loca.version,l=t.AMap.version.startsWith("2"),r=c.startsWith("2");if(l&&!r||!l&&r)e("JSAPI 与 Loca 版本不对应！！");else{l=t.key,r=document.body||document.head;var p=document.createElement("script");p.type="text/javascript",p.src="https://webapi.amap.com/loca?v="+c+"&key="+l,p.onerror=function(n){a.Loca=i.failed,e("请求 AMapUI 失败")},p.onload=function(){for(a.Loca=i.loaded,o();s.Loca.length;)s.Loca.splice(0,1)[0]()},r.appendChild(p)}}else a.Loca===i.loaded?n.version&&n.version!==t.Loca.version?e("不允许多个版本 Loca 混用"):o():n.version&&n.version!==t.Loca.version?e("不允许多个版本 Loca 混用"):s.Loca.push((function(n){n?e(n):e()}))}))}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var i;(function(n){n.notload="notload",n.loading="loading",n.loaded="loaded",n.failed="failed"})(i||(i={}));var t={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},a={AMap:i.notload,AMapUI:i.notload,Loca:i.notload},s={AMap:[],AMapUI:[],Loca:[]},c=[],l=function(n){"function"==typeof n&&(a.AMap===i.loaded?n(window.AMap):c.push(n))};return{load:function(o){return new Promise((function(e,s){if(a.AMap==i.failed)s("");else if(a.AMap==i.notload){var r=o.key,p=o.version,u=o.plugins;r?(window.AMap&&"lbs.amap.com"!==location.host&&s("禁止多种API加载方式混用"),t.key=r,t.AMap.version=p||t.AMap.version,t.AMap.plugins=u||t.AMap.plugins,a.AMap=i.loading,p=document.body||document.head,window.___onAPILoaded=function(t){if(delete window.___onAPILoaded,t)a.AMap=i.failed,s(t);else for(a.AMap=i.loaded,n(o).then((function(){e(window.AMap)}))["catch"](s);c.length;)c.splice(0,1)[0]()},u=document.createElement("script"),u.type="text/javascript",u.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+t.AMap.version+"&key="+r+"&plugin="+t.AMap.plugins.join(","),u.onerror=function(n){a.AMap=i.failed,s(n)},p.appendChild(u)):s("请填写key")}else if(a.AMap==i.loaded)if(o.key&&o.key!==t.key)s("多个不一致的 key");else if(o.version&&o.version!==t.AMap.version)s("不允许多个版本 JSAPI 混用");else{if(r=[],o.plugins)for(p=0;p<o.plugins.length;p+=1)-1==t.AMap.plugins.indexOf(o.plugins[p])&&r.push(o.plugins[p]);r.length?window.AMap.plugin(r,(function(){n(o).then((function(){e(window.AMap)}))["catch"](s)})):n(o).then((function(){e(window.AMap)}))["catch"](s)}else if(o.key&&o.key!==t.key)s("多个不一致的 key");else if(o.version&&o.version!==t.AMap.version)s("不允许多个版本 JSAPI 混用");else{var d=[];if(o.plugins)for(p=0;p<o.plugins.length;p+=1)-1==t.AMap.plugins.indexOf(o.plugins[p])&&d.push(o.plugins[p]);l((function(){d.length?window.AMap.plugin(d,(function(){n(o).then((function(){e(window.AMap)}))["catch"](s)})):n(o).then((function(){e(window.AMap)}))["catch"](s)}))}}))},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,t={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},a={AMap:i.notload,AMapUI:i.notload,Loca:i.notload},s={AMap:[],AMapUI:[],Loca:[]}}}}))},aee5:function(n,o,e){"use strict";e("1a3f")}}]);